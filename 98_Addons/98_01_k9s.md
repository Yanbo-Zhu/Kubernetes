
# 1 å®‰è£… 

https://k9scli.io/topics/install/
https://github.com/derailed/k9s


## 1.1 Windowsä¸Šé¢ç”¨Chocoå®‰è£… 

```
choco install k9s

choco upgrade k9s 
```


## 1.2 Ubuntu on WSL 

https://snapcraft.io/install/k9s/ubuntu
https://github.com/derailed/k9s/issues/2128
https://askubuntu.com/questions/1258137/cannot-communicate-with-server-post-http-localhost-v2-apps-dial-unix-run-sn

https://shallwelearn.com/2024/03/04/use-kind-and-k9s-to-learn-kubernetes-locally-on-ubuntu/


å…ˆå®‰è£… snap
```
sudo apt update
sudo apt install snapd
```

---


åœ¨å®‰è£… k9s
sudo snap install k9s

ä¼šæŠ¥é”™ 

```
snap install k9s
error: cannot communicate with server: Post "http://localhost/v2/snaps/chromium": dial unix /run/snapd.socket: connect: no such file or directory
```


è§£å†³æ–¹å¼
```
boot]
systemd=true
```

to /etc/wsl.conf , then restarting WSL :) (starting PowerShell as administrator and running wsl --shutdown), now Snap works great


ç„¶å 

```
Unmask the snapd.service:
sudo systemctl unmask snapd.service

Enable it:
sudo systemctl enable snapd.service

Start it:
sudo systemctl start snapd.service
```


---


æ— æ³•ç›´æ¥ä½¿ç”¨k9s , 

error
```
ubuntu@k9s-node:~$ k9s
Command 'k9s' not found, did you mean:
  command 'kas' from deb kas (2.6.3-2)
Try: sudo apt install <deb name>
```

éœ€è¦åœ¨ ~/.bashrc ä¸­åŠ å…¥ 
```
alias k9s=/snap/k9s/current/bin/k9s
```

ç„¶å source ~/.bashrc 


# 2 å¸–å­

1 
ã€kubernetes-å·¥å…·ç¯‡ã€‘K9Sè¯¦è§£-å®è—k8sç•Œé¢å·¥å…·
https://blog.csdn.net/m0_37904728/article/details/129985153


2 
K9s
https://i.cloudnative.to/toolkits/kubernetes/k9s

3
å¼€ç¯‡
https://www.cnblogs.com/east4ming/p/17178470.html




# 3 K9S åŠŸèƒ½

- ä¿¡æ¯è§¦æ‰‹å¯åŠï¼
    - è·Ÿè¸ª Kubernetes é›†ç¾¤ä¸­è¿è¡Œçš„èµ„æºçš„å®æ—¶æ´»åŠ¨ã€‚
- æ ‡å‡†èµ„æºæˆ– CRDï¼Ÿ
    - å¤„ç† Kubernetes æ ‡å‡†èµ„æºå’Œè‡ªå®šä¹‰èµ„æºå®šä¹‰ï¼ˆå³ï¼šCRDï¼‰ã€‚
- é›†ç¾¤æŒ‡æ ‡
    - è·Ÿè¸ªä¸ podã€å®¹å™¨å’ŒèŠ‚ç‚¹ï¼ˆnodeï¼‰ç­‰èµ„æºç›¸å…³çš„å®æ—¶æŒ‡æ ‡ã€‚
- å—åˆ°é«˜çº§ç”¨æˆ·æ¬¢è¿ï¼
    - æä¾›æ ‡å‡†çš„é›†ç¾¤ç®¡ç†å‘½ä»¤ï¼Œå¦‚æ—¥å¿—ã€ä¼¸ç¼©ã€ç«¯å£è½¬å‘ã€é‡å¯ç­‰
    - **å®šä¹‰æ‚¨è‡ªå·±çš„å‘½ä»¤å¿«æ·é”®**ï¼Œé€šè¿‡å‘½ä»¤åˆ«åå’Œçƒ­é”®å¿«é€Ÿå¯¼èˆªã€‚
    - k9s æ”¯æŒæ’ä»¶æ‰©å±•ï¼Œä»¥åˆ›å»ºæ‚¨è‡ªå·±çš„é›†ç¾¤å‘½ä»¤ã€‚
    - å¼ºå¤§çš„è¿‡æ»¤æ¨¡å¼ï¼Œå…è®¸ç”¨æˆ·æ·±å…¥å’ŒæŸ¥çœ‹ä¸å·¥ä½œè´Ÿè½½ç›¸å…³çš„èµ„æºã€‚
- é”™è¯¯é’»å–
    - ç›´æ¥é’»å–ç¾¤é›†èµ„æºçš„é”™è¯¯ã€‚
- çš®è‚¤å’Œå¯å®šåˆ¶æ€§
    - é€šè¿‡ K9s çš®è‚¤å®šä¹‰æ‚¨è‡ªå·±çš„å¤–è§‚å’Œæ„Ÿè§‰ã€‚
    - è‡ªå®šä¹‰/æ’åˆ—è¦åœ¨æ¯ä¸ªèµ„æºåŸºç¡€ä¸Šæ˜¾ç¤ºçš„åˆ—ã€‚
- çª„æˆ–å®½?
    - æä¾›æŸ¥çœ‹æœ€å°æˆ–å®Œæ•´èµ„æºå®šä¹‰çš„åˆ‡æ¢
- å¤šèµ„æºè§†å›¾
    - é€šè¿‡ **Pulses** å’Œ **XRay** è§†å›¾æä¾›é›†ç¾¤èµ„æºçš„æ¦‚è¿°ã€‚
- æˆ‘ä»¬æ‹¿åˆ°ä½ çš„ RBAC äº†ï¼
    - æ”¯æŒæŸ¥çœ‹ RBAC è§„åˆ™ï¼Œå¦‚é›†ç¾¤/è§’è‰²åŠå…¶å…³è”ç»‘å®šã€‚
    - åå‘æŸ¥æ‰¾æ–­è¨€ç”¨æˆ·/ç»„æˆ– ServiceAccount åœ¨é›†ç¾¤ä¸Šå¯ä»¥åšä»€ä¹ˆã€‚
- å†…ç½®åŸºå‡†æµ‹è¯•ï¼ˆBenchmarkingï¼‰
    - æ‚¨å¯ä»¥ç›´æ¥ä»K9så¯¹HTTPæœåŠ¡/podè¿›è¡ŒåŸºå‡†æµ‹è¯•ï¼Œä»¥æŸ¥çœ‹åº”ç”¨ç¨‹åºçš„è¿è¡Œæƒ…å†µï¼Œå¹¶ç›¸åº”åœ°è°ƒæ•´èµ„æºè¯·æ±‚/é™åˆ¶ã€‚
- èµ„æºå›¾éå†
    - K9s æä¾›äº† Kubernetes èµ„æºåŠå…¶å…³è”èµ„æºçš„ç®€å•éå†ã€‚

# 4 åŸºç¡€ç•Œé¢


![](https://i.cloudnative.to/~gitbook/image?url=https%3A%2F%2F2547706445-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-legacy-files%2Fo%2Fassets%252F-MNIMs8Ubg1Uqdpgfw0o%252F-MO9zTNxi9Wxg2V7HfLc%252F-MOAPJYScwIoFVzm7ySC%252Fimage.png%3Falt%3Dmedia%26token%3D861cfd23-379b-47c2-ad29-c8b121265fa3&width=768&dpr=4&quality=100&sign=ce4bc075&sv=1)

K9s è¿è¡Œç•Œé¢ç¤ºä¾‹

- ğŸ’™ **è“è‰²åŒºåŸŸ**ï¼šå½“å‰ K8s çš„ä¸Šä¸‹æ–‡ã€å½“å‰é›†ç¾¤ã€å½“å‰ K9s åŠ K8s ç‰ˆæœ¬ç­‰ä¿¡æ¯
    
- ğŸ’š **ç»¿è‰²åŒºåŸŸ**ï¼šæ•°å­— `0, 1, 2 ... 9` ä»£è¡¨äº†ä¸åŒçš„ Namespaceï¼Œåœ¨ç•Œé¢ä¸­ç›´æ¥æŒ‰å¯¹åº”æ•°å­—å³å¯è¿›è¡Œåˆ‡æ¢æ˜¾ç¤º
    
- â¤ï¸ **çº¢è‰²åŒºåŸŸ**ï¼šå½“å‰è§†å›¾ä¸‹æ‰€æœ‰å¯æ“ä½œçš„è§†å›¾ä¸“æœ‰å‘½ä»¤

# 5 The Command Line


```
# List current version
k9s version

# To get info about K9s runtime (logs, configs, etc..)
k9s info

# List all available CLI options
k9s help

# To run K9s in a given namespace
k9s -n mycoolns

# Start K9s in an existing KubeConfig context
k9s --context coolCtx

# Start K9s in readonly mode - with all cluster modification commands disabled
k9s --readonly
```


## 5.1 k9s info æ˜¾ç¤º å„ä¸ªé…ç½®æ–‡ä»¶çš„ä½ç½® 

Windows ä¸Šé¢ 
```
Version:           v0.32.5
Config:            C:\Users\yzh\AppData\Local\k9s\config.yaml
Custom Views:      C:\Users\yzh\AppData\Local\k9s\views.yaml
Plugins:           C:\Users\yzh\AppData\Local\k9s\plugins.yaml
Hotkeys:           C:\Users\yzh\AppData\Local\k9s\hotkeys.yaml
Aliases:           C:\Users\yzh\AppData\Local\k9s\aliases.yaml
Skins:             C:\Users\yzh\AppData\Local\k9s\skins
Context Configs:   C:\Users\yzh\AppData\Local\k9s\clusters
Logs:              C:\Users\yzh\AppData\Local\k9s\k9s.log
Benchmarks:        C:\Users\yzh\AppData\Local\k9s\benchmarks
ScreenDumps:       C:\Users\yzh\AppData\Local\k9s\screen-dumps
```



unbuntu on wsl ä¸Šé¢ 

```
Configuration:   /home/yzh/.config/k9s/config.yml
Logs:            /tmp/k9s-yzh.log
Screen Dumps:    /tmp/k9s-screens-yzh
```



ä¸ºäº† hotkey é€ ä¸€ä¸ªè½¯è¿æ¥
å¾ˆå¯æƒœè¿™ä¸ªè½¯è¿æ¥ä¸èµ·ä½œç”¨ 
```
ln â€“s /mnt/c/Users/yzh/AppData/Local/k9s/hotkeys.yaml /home/yzh/.config/k9s/hotkey.yml
```


![](image/Pasted%20image%2020240727185225.png)

# 6 Key Bindings

9s uses aliases to navigate most K8s resources.

| Action                                                                                                                                        | Command                  | Comment                                                                                                                                                                                            |
| --------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Show active keyboard mnemonics and help<br>æ˜¾ç¤ºæœ‰é‚£äº›å¿«æ·é”®                                                                                           | `?`                      |                                                                                                                                                                                                    |
| Show all available resource alias <br>æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„èµ„æºåˆ«å                                                                                             | `ctrl-a`                 |                                                                                                                                                                                                    |
| To bail out of K9s<br>é€€å‡º K9s                                                                                                                  | `:quit`, `:q`, `ctrl-c`  |                                                                                                                                                                                                    |
| View a Kubernetes resource using singular/plural or short-name<br><br>ç”¨å•æ•°/å¤æ•°æˆ–çŸ­åæ¥æŸ¥çœ‹ Kubernetes èµ„æºï¼Œå¦‚ `po`, `dp`, `svc`, `cm`, `sec`, `rb`, etc. | `:`podâ                  | accepts singular, plural, short-name or alias ie pod or pods                                                                                                                                       |
| View a Kubernetes resource in a given namespace                                                                                               | `:`pod namespaceNameâ    |                                                                                                                                                                                                    |
| View filtered pods (New v0.30.0!)                                                                                                             | `:`pod /fredâ            | View all pods filtered by fred                                                                                                                                                                     |
| View labeled pods (New v0.30.0!)                                                                                                              | `:`pod app=fred,env=devâ | View all pods with labels matching app=fred and env=dev                                                                                                                                            |
| View pods in a given context (New v0.30.0!)                                                                                                   | `:`pod @ctx1â            | View all pods in context ctx1. Switches out your current k9s context!                                                                                                                              |
| æŸ¥çœ‹ç»™å®šåç§°ç©ºé—´ä¸­çš„Kubernetes èµ„æº                                                                                                                       | :alias namespaceâ        |                                                                                                                                                                                                    |
| Filter out a resource view given a filter<br><br>ç­›é€‰å‡ºä¸€ä¸ªèµ„æºè§†å›¾ï¼Œç»™å®šä¸€ä¸ªè¿‡æ»¤å™¨                                                                            | `/`filterâ               | Regex2 supported ie `fred                                                                                                                                                                          |
| Inverse regex filter<br><br>åå‘æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤å™¨                                                                                                        | `/`! filterâ             | Keep everything that _doesn't_ match.<br><br>ä¿ç•™æ‰€æœ‰ä¸åŒ¹é…çš„ä¸œè¥¿ã€‚æ—¥å¿—æœªå®ç°ã€‚                                                                                                                                     |
| Filter resource view by labels<br><br>æŒ‰æ ‡ç­¾è¿‡æ»¤èµ„æºè§†å›¾                                                                                               | `/`-l label-selectorâ    |                                                                                                                                                                                                    |
| Fuzzy find a resource given a filter<br><br>æ¨¡ç³ŠæŸ¥æ‰¾ç»™å®šä¸€ä¸ªå…³é”®å­—çš„èµ„æº                                                                                    | `/`-f filterâ            |                                                                                                                                                                                                    |
| `<space>`                                                                                                                                     | æ ‡è®°é€‰ä¸­èµ„æº                   | è¢«æ ‡è®°çš„èµ„æºä¼šåœ¨k9sç•Œé¢ä¸­é«˜äº®æ˜¾ç¤º                                                                                                                                                                                 |
| Bails out of view/command/filter mode                                                                                                         | `<esc>`                  |                                                                                                                                                                                                    |
| å¤åˆ¶å½“å‰æ‰€é€‰ï¼ˆæ‰€åœ¨ï¼‰çš„èµ„æºçš„åç§°                                                                                                                              | c                        |                                                                                                                                                                                                    |
| Key mapping to describe, view, edit, view logs,...<br>å¸¸ç”¨å‘½ä»¤æ¥æè¿°ã€æŸ¥çœ‹ YAMLã€ç¼–è¾‘ YAMLã€æŸ¥çœ‹æ—¥å¿—ç­‰ç­‰                                                          | `d`,`v`, `e`, `l`,...    | d: æ˜¾ç¤ºèµ„æºæè¿° ç­‰åŒäºè¿è¡Œkubectl describeå‘½ä»¤<br><br>y: æ˜¾ç¤ºèµ„æºçš„yamlæ–‡ä»¶å†…å®¹ ç­‰åŒäºkubectl get xxx -o yamlå‘½ä»¤<br><br>e ç¼–è¾‘é€‰ä¸­çš„èµ„æº è¿›å…¥ç¼–è¾‘åï¼Œé»˜è®¤æ˜¯vimç¼–è¾‘å™¨ï¼Œå®Œæˆå:wqé€€å‡ºåç«‹å³ç”Ÿæ•ˆ<br><br>l æ˜¾ç¤ºpodçš„æ—¥å¿— æ˜¾ç¤ºlogçš„æ—¥å¿—ä¿¡æ¯ï¼Œå¯ä»¥æŒ‰`<w>`é”®åˆ‡æ¢æ˜¾ç¤ºçš„æ ¼å¼(è‡ªåŠ¨æ¢è¡Œ)<br> <br> |
| <: èµ„æºç±»å‹>                                                                                                                                      | æ˜¾ç¤ºæŸç§ç±»å‹çš„æ‰€æœ‰èµ„æº              | å¸¸ç”¨çš„æœ‰: : ns(æ˜¾ç¤ºæ‰€æœ‰namespace)ï¼Œ : pods(æ˜¾ç¤ºæ‰€æœ‰pods)ç­‰ï¼Œ èµ„æºç±»å‹å¯ä»¥å†™å…¨ç§°ä¹Ÿå¯ä»¥å†™ç¼©å†™ï¼Œå¦‚serviceçš„ç¼©å†™æ˜¯svc, statefulsetçš„ç¼©å†™æ˜¯sts, daemonsetçš„ç¼©å†™æ˜¯ds                                                                                 |
| To view and switch to another Kubernetes namespace<br><br>æŸ¥çœ‹å¹¶åˆ‡æ¢åˆ°å¦ä¸€ä¸ª Kubernetes åç§°ç©ºé—´                                                           | `:`nsâ                   |                                                                                                                                                                                                    |
| To view all saved resources<br><br>æŸ¥çœ‹æ‰€æœ‰å·²ä¿å­˜çš„èµ„æº                                                                                                 | `:`screendump or sdâ     |                                                                                                                                                                                                    |
| åˆ‡æ¢æŸ¥çœ‹å½“å‰èµ„æºçš„æ›´å¤š/æ›´å°‘ä¿¡æ¯                                                                                                                              | ctrl-w                   |                                                                                                                                                                                                    |
| To delete a resource (TAB and ENTER to confirm)<br>åˆ é™¤ä¸€ä¸ªèµ„æºï¼ˆ`TAB` é”®å’Œ `ENTER` é”®ç¡®è®¤ï¼‰                                                               | `ctrl-d`                 |                                                                                                                                                                                                    |
| To kill a resource (no confirmation dialog, equivalent to kubectl delete --now)<br>åˆ é™¤ä¸€ä¸ªèµ„æºï¼ˆç›´æ¥åˆ é™¤ï¼Œä¸ä¼šæœ‰ç¡®è®¤ï¼ï¼‰                                        | `ctrl-k`                 |                                                                                                                                                                                                    |
| åˆ‡æ¢å®½åˆ—                                                                                                                                          | ctrl-w                   | ç­‰åŒäº kubectl ... -o wide                                                                                                                                                                            |
| åˆ‡æ¢é”™è¯¯çŠ¶æ€                                                                                                                                        | ctrl-z                   | æŸ¥çœ‹æœ‰é”™è¯¯çš„èµ„æº                                                                                                                                                                                           |


| To view and switch to another Kubernetes context (Pod view)<br><br>æŸ¥çœ‹å’Œåˆ‡æ¢åˆ°å¦ä¸€ä¸ª Kubernetes é›†ç¾¤ç¯å¢ƒ                   | `:`ctxâ                       | æŸ¥çœ‹æ‰€æœ‰å¯è®¿é—®çš„k8sé›†ç¾¤ï¼Œé€‰ä¸­æŸä¸ªé›†ç¾¤åå›è½¦å¯ä½¿ç”¨å…¶é…ç½®æ–‡ä»¶ï¼Œè¿æ¥å¯¹åº”çš„é›†ç¾¤                                                                                                                                                                                                                                            |
| -------------------------------------------------------------------------------------------------------------- | ----------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| To view and switch directly to another Kubernetes context (Last used view)<br><br>æŸ¥çœ‹å’Œåˆ‡æ¢åˆ°å¦ä¸€ä¸ªæŒ‡å®šçš„ Kubernetes é›†ç¾¤ç¯å¢ƒ | `:`ctx context-nameâ          |                                                                                                                                                                                                                                                                                    |
| Launch pulses view                                                                                             | `:`pulses or puâ              | å¦‚å›¾å¯ä»¥æ˜¾ç¤ºé›†ç¾¤çš„èµ„æºä½¿ç”¨æƒ…å†µä»¥åŠå¥åº·çŠ¶æ€ï¼Œå¦‚ä¸‹å›¾ï¼Œæ˜¾ç„¶æœ‰ä¸€ä¸ªpodå¤„äºé”™è¯¯çŠ¶æ€ï¼Œæ ¹æ®é¡¶éƒ¨æç¤ºï¼ŒæŒ‰4å¯ä»¥è¿›å…¥åˆ°podsç•Œé¢æŸ¥çœ‹ï¼Œå†æŒ‰`<ctrl-z>`å¯ä»¥æŸ¥çœ‹é”™è¯¯çš„pod<br><br>                                                                                                                                                                                     |
| Launch XRay view                                                                                               | `:`xray RESOURCE [NAMESPACE]â | RESOURCE can be one of po, svc, dp, rs, sts, ds, NAMESPACE is optional<br><br>èµ„æºå¯ä»¥æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼špo, svc, dp, rs, sts, ds, NAMESPACE å‚æ•°å¯é€‰<br><br><br>å¦‚ï¼š<: xray deployments>ï¼Œ <: xray deployments default>, åˆ†åˆ«æ˜¯æŸ¥çœ‹æ‰€æœ‰namespace/æŒ‡å®šnamespaceä¸‹ä»¥deploymentsä¸ºç»´åº¦çš„å„èµ„æºçš„è”ç³»ï¼Œä¸åŒçš„èµ„æºç±»å‹ä¼šç”¨ä¸åŒçš„å›¾æ ‡è¡¨ç¤ºï¼Œå¦‚ä¸‹å›¾<br><br> |
| Launch Popeye view                                                                                             | `:`popeye or popâ             | See [popeye](https://github.com/derailed/k9s#popeye)<br><br><br>é€‰ä¸­æŸé¡¹å…·ä½“çš„èµ„æºï¼ŒæŒ‰ä¸‹å›è½¦é”®ï¼Œä¼šæ˜¾ç¤ºæ›´åŠ è¯¦ç»†çš„è¯„ä»·ä¿¡æ¯ï¼Œå¦‚é€‰ä¸­daemonsets, ä¼šæ˜¾ç¤ºå…·ä½“æ‰£åˆ†çš„åŸå› ï¼Œå¦‚ä¸‹å›¾ï¼Œä¼šå› ä¸ºæ²¡æœ‰ä¸ºportå‘½åå’Œæ²¡æœ‰è®¾ç½®èµ„æºé™åˆ¶è€Œå½±å“è¯„åˆ†<br><br>                                                                                                                      |
| <: crb>/<: clusterrolebinding>                                                                                 | æŸ¥çœ‹RBAC                        | å¯ä»¥ç›´è§‚çš„æŸ¥çœ‹é›†ç¾¤çš„RBACä¿¡æ¯ï¼Œ æ‰§è¡Œå‘½ä»¤åï¼Œå¯ä»¥é€‰ä¸­æŸä¸ªå…·ä½“çš„Clusterrolebinding, å›è½¦æŸ¥çœ‹è¯¦ç»†æƒé™ï¼Œå¦‚ä¸‹å›¾ï¼Œ æŸ¥çœ‹k9sè¿™ä¸ªclusterroleçš„å…·ä½“æƒé™ï¼š                                                                                                                                                                                        |
|                                                                                                                |                               |                                                                                                                                                                                                                                                                                    |

# 7 Logs And Debug Logs


Given the nature of the ui k9s does produce logs to a specific location. To view the logs and turn on debug mode, use the following commands:

```shell
# Find out where the logs are stored
k9s info
```

```
 ____  __.________
|    |/ _/   __   \______
|      < \____    /  ___/
|    |  \   /    /\___ \
|____|__ \ /____//____  >
        \/            \/

Version:           vX.Y.Z
Config:            /Users/fernand/.config/k9s/config.yaml
Logs:              /Users/fernand/.local/state/k9s/k9s.log
Dumps dir:         /Users/fernand/.local/state/k9s/screen-dumps
Benchmarks dir:    /Users/fernand/.local/state/k9s/benchmarks
Skins dir:         /Users/fernand/.local/share/k9s/skins
Contexts dir:      /Users/fernand/.local/share/k9s/clusters
Custom views file: /Users/fernand/.local/share/k9s/views.yaml
Plugins file:      /Users/fernand/.local/share/k9s/plugins.yaml
Hotkeys file:      /Users/fernand/.local/share/k9s/hotkeys.yaml
Alias file:        /Users/fernand/.local/share/k9s/aliases.yaml
```

## 7.1 View K9s logs

tail -f /Users/fernand/.local/data/k9s/k9s.log

## 7.2 Start K9s in debug mode

k9s -l debug

## 7.3 Customize logs destination

You can override the default log file destination either with the `--logFile` argument:

```shell
k9s --logFile /tmp/k9s.log
less /tmp/k9s.log
```

Or through the `K9S_LOGS_DIR` environment variable:

```shell
K9S_LOGS_DIR=/var/log k9s
less /var/log/k9s.log
```


# 8 K9s Configuration

## 8.1 é…ç½®æ–‡ä»¶

K9s keeps its configurations as YAML files inside of a `k9s` directory and the location depends on your operating system. K9s leverages [XDG](https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html) to load its various configurations files. For information on the default locations for your OS please see [this link](https://github.com/adrg/xdg/blob/master/README.md). If you are still confused a quick `k9s info` will reveal where k9s is loading its configurations from. Alternatively, you can set `K9S_CONFIG_DIR` to tell K9s the directory location to pull its configurations from.

| Unix            | macOS                               | Windows              |
| --------------- | ----------------------------------- | -------------------- |
| `~/.config/k9s` | `~/Library/Application Support/k9s` | `%LOCALAPPDATA%\k9s` |

You can now override the context portForward default address configuration by setting an env variable that can override all clusters portForward local address using `K9S_DEFAULT_PF_ADDRESS=a.b.c.d`


k9s config.yaml
```
# $XDG_CONFIG_HOME/k9s/config.yaml
k9s:
  # Enable periodic refresh of resource browser windows. Default false
  liveViewAutoRefresh: false
  # The path to screen dump. Default: '%temp_dir%/k9s-screens-%username%' (k9s info)
  screenDumpDir: /tmp/dumps
  # Represents ui poll intervals. Default 2secs
  refreshRate: 2
  # Number of retries once the connection to the api-server is lost. Default 15.
  maxConnRetry: 5
  # Indicates whether modification commands like delete/kill/edit are disabled. Default is false
  readOnly: false
  # Toggles whether k9s should exit when CTRL-C is pressed. When set to true, you will need to exist k9s via the :quit command. Default is false.
  noExitOnCtrlC: false
  #UI settings
  ui:
    # Enable mouse support. Default false
    enableMouse: false
    # Set to true to hide K9s header. Default false
    headless: false
    # Set to true to hide the K9S logo Default false
    logoless: false
    # Set to true to hide K9s crumbs. Default false
    crumbsless: false
    noIcons: false
    # Toggles reactive UI. This option provide for watching on disk artifacts changes and update the UI live Defaults to false.
    reactive: false
    # By default all contexts wil use the dracula skin unless explicitly overridden in the context config file.
    skin: dracula # => assumes the file skins/dracula.yaml is present in the  $XDG_DATA_HOME/k9s/skins directory
    # Allows to set certain views default fullscreen mode. (yaml, helm history, describe, value_extender, details, logs) Default false
    defaultsToFullScreen: false
  # Toggles icons display as not all terminal support these chars.
  noIcons: false
  # Toggles whether k9s should check for the latest revision from the Github repository releases. Default is false.
  skipLatestRevCheck: false
  # When altering kubeconfig or using multiple kube configs, k9s will clean up clusters configurations that are no longer in use. Setting this flag to true will keep k9s from cleaning up inactive cluster configs. Defaults to false.
  keepMissingClusters: false
  # Logs configuration
  logger:
    # Defines the number of lines to return. Default 100
    tail: 200
    # Defines the total number of log lines to allow in the view. Default 1000
    buffer: 500
    # Represents how far to go back in the log timeline in seconds. Setting to -1 will tail logs. Default is -1.
    sinceSeconds: 300 # => tail the last 5 mins.
    # Toggles log line wrap. Default false
    textWrap: false
    # Toggles log line timestamp info. Default false
    showTime: false
  # Provide shell pod customization when nodeShell feature gate is enabled!
  shellPod:
    # The shell pod image to use.
    image: killerAdmin
    # The namespace to launch to shell pod into.
    namespace: default
    # The resource limit to set on the shell pod.
    limits:
      cpu: 100m
      memory: 100Mi
    # Enable TTY
    tty: true
```



## 8.2 Command Aliases

In K9s, you can define your very own command aliases (shortnames) to access your resources. In your `$HOME/.config/k9s` define a file called `aliases.yaml`. A K9s alias defines pairs of alias:gvr. A gvr (Group/Version/Resource) represents a fully qualified Kubernetes resource identifier. Here is an example of an alias file:

```yaml
#  $XDG_DATA_HOME/k9s/aliases.yaml
aliases:
  pp: v1/pods
  crb: rbac.authorization.k8s.io/v1/clusterrolebindings
  # As of v0.30.0 you can also refer to another command alias...
  fred: pod fred app=blee # => view pods in namespace fred with labels matching app=blee
```

Using this aliases file, you can now type `:pp` or `:crb` or `:fred` to activate their respective commands.


## 8.3 HotKey Support

Entering the command mode and typing a resource name or alias, could be cumbersome for navigating thru often used resources. We're introducing hotkeys that allow users to define their own key combination to activate their favorite resource views.

Additionally, you can define context specific hotkeys by add a context level configuration file in `$XDG_DATA_HOME/k9s/clusters/clusterX/contextY/hotkeys.yaml`
Create a file named `$XDG_CONFIG_HOME/k9s/hotkeys.yaml`
In order to surface hotkeys globally please follow these steps:


### 8.3.1 ubantu on wsl 

LinuxL: åˆ›å»º `$HOME/.k9s/hotkey.yml` æŒ‰å¦‚ä¸‹æ ¼å¼å½•å…¥å†…å®¹ï¼Œ
 
/home/yzh/.config/k9s/hotkey.yml  æ³¨æ„hotkey.yml å¿…é¡»æ²¡æœ‰s, å¿…é¡»ä¸º yml , æ³¨æ„å¿…é¡»æ²¡æœ‰s , å¦åˆ™è¯†åˆ«ä¸å‡ºæ¥

```
# $HOME/.k9s/hotkey.yml
hotKey:  # æ³¨æ„å¿…é¡»æ²¡æœ‰s , å¦åˆ™è¯†åˆ«ä¸å‡ºæ¥
  # Hitting Shift-1 navigates to your nodes 
  shift-1:
    shortCut:    Shift-2
    description: View nodes
    command:     no
  # Hitting Shift-2 navigates to your pod view
  shift-2:
    shortCut:    Shift-2
    description: Viewing pods
    command:     pods
  # Hitting Shift-3 navigates to your deployments
  shift-3:
    shortCut:    Shift-3
    description: View deployments
    command:     dp
  # Hitting Shift-4 navigates to your services 
  shift-4:
    shortCut:    Shift-4
    description: View services
    command:     svc
  # Hitting Shift-5 navigates to your statefulsets view
  shift-5:
    shortCut:    Shift-5
    description: Viewing statefulsets
    command:     sts
  # Hitting Shift-6 navigates to your daemonsets
  shift-6:
    shortCut:    Shift-6
    description: View daemonsets
    command:     ds
  # Hitting Shift-S view the resources in the namespace of your current selection
  shift-s:
    shortCut:    Shift-S
    override:    true # => will override the default shortcut related action if set to true (default to false)
    description: Namespaced resources
    command:     "$RESOURCE_NAME $NAMESPACE"
    keepHistory: true # whether you can return to the previous view
```




### 8.3.2 powershellä¸­ 


1. Windows: `c:\Users\yzh\AppData\Local\k9s\hotkeys.yaml`
2. Add the following to your `hotkeys.yaml`. You can use resource name/short name to specify a command ie same as typing it while in command mode.

    ```yaml
    #  $XDG_CONFIG_HOME/k9s/hotkeys.yaml
    hotKeys:
      # Hitting Shift-0 navigates to your pod view
      shift-0:
        shortCut:    Shift-0
        description: Viewing pods
        command:     pods
      # Hitting Shift-1 navigates to your deployments
      shift-1:
        shortCut:    Shift-1
        description: View deployments
        command:     dp
      # Hitting Shift-2 navigates to your xray deployments
      shift-2:
        shortCut:    Shift-2
        description: Xray Deployments
        command:     xray deploy
      # Hitting Shift-S view the resources in the namespace of your current selection
      shift-s:
        shortCut:    Shift-S
        override:    true # => will override the default shortcut related action if set to true (default to false)
        description: Namespaced resources
        command:     "$RESOURCE_NAME $NAMESPACE"
        keepHistory: true # whether you can return to the previous view
    ```

ç”¨è¿™ä¸ª: 
```yaml
# $HOME/.k9s/hotkeys.yaml
hotKeys:
  # Hitting Shift-1 navigates to your cluster 
  shift-1:
    shortCut:    Shift-1
    override:    true # => will override the default shortcut related action if set to true (default to false)
    description: View cluster
    command:     ctx
  # Hitting Shift-2 navigates to your nodes 
  shift-2:
    shortCut:    Shift-2
    override:    true # => will override the default shortcut related action if set to true (default to false)
    description: View nodes
    command:     no
  # Hitting Shift-3 navigates to your services 
  shift-3:
    shortCut:    Shift-3
    override:    true # => will override the default shortcut related action if set to true (default to false)
    description: View namespaces
    command:     ns
  # Hitting Shift-4 navigates to your deployments
  shift-4:
    shortCut:    Shift-4
    override:    true # => will override the default shortcut related action if set to true (default to false)
    description: View deployments
    command:     dp
  # Hitting Shift-3 navigates to your pod view
  shift-5:
    shortCut:    Shift-5
    override:    true # => will override the default shortcut related action if set to true (default to false)
    description: Viewing pods
    command:     pods
  # Hitting Shift-6 navigates to your services 
  shift-6:
    shortCut:    Shift-6
    override:    true # => will override the default shortcut related action if set to true (default to false)
    description: View services
    command:     svc
  # Hitting Shift-9 navigates to your endpoints
  shift-7:
    shortCut:    Shift-7
    description: View endpoints
    command:     ep
  # Hitting Shift-0 navigates to your endpoints
  shift-8:
    shortCut:    Shift-8
    description: View configmaps
    command:     cm
  # Hitting Shift-8 navigates to your daemonsets
  shift-9:
    shortCut:    Shift-9
    override:    true # => will override the default shortcut related action if set to true (default to false)
    description: View secret
    command:     sec
  # Hitting Shift-7 navigates to your statefulsets view
  shift-0:
    shortCut:    Shift-0
    override:    true # => will override the default shortcut related action if set to true (default to false)
    description: Viewing statefulsets
    command:     sts
  # Hitting Shift-8 navigates to your daemonsets
  shift-P:
    shortCut:    Shift-P
    override:    true # => will override the default shortcut related action if set to true (default to false)
    description: View daemonsets
    command:     ds
  # Hitting Shift-X navigates to your xray deployments
  shift-X:
    shortCut:    Shift-X
    override:    true # => will override the default shortcut related action if set to true (default to false)
    description: Xray Deployments
    command:     xray deploy
  # Hitting Shift-S view the resources in the namespace of your current selection
  shift-s:
    shortCut:    Shift-S
    override:    true # => will override the default shortcut related action if set to true (default to false)
    description: Namespaced resources
    command:     "$RESOURCE_NAME $NAMESPACE"
    keepHistory: true # whether you can return to the previous view
```


Not feeling so hot? Your custom hotkeys will be listed in the help view `?`. Also your hotkeys file will be automatically reloaded so you can readily use your hotkeys as you define them.

You can choose any keyboard shortcuts that make sense to you, provided they are not part of the standard K9s shortcuts list.

Similarly, referencing environment variables in hotkeys is also supported. The available environment variables can refer to the description in the [Plugins](https://github.com/derailed/k9s#plugins) section.



## 8.4 Skins

çš®è‚¤åº“
https://github.com/derailed/k9s/tree/master/skins

`C:\Users\yzh\AppData\Local\k9s\skins`  ä¸­æ”¾å…¥ one-dark.yaml 

ç„¶ååœ¨ `C:\Users\yzh\AppData\Local\k9s\config.yaml` ä¸­çš„ ui ä¸‹ å†™å…¥ 

```
k9s:
  ui:
    # Enable mouse support. Default false
    enableMouse: false
    # Set to true to hide K9s header. Default false
    headless: false
    # Set to true to hide the K9S logo Default false
    logoless: false
    # Set to true to hide K9s crumbs. Default false
    crumbsless: false
    noIcons: false
    # Toggles reactive UI. This option provide for watching on disk artifacts changes and update the UI live Defaults to false.
    reactive: false
    # By default all contexts wil use the dracula skin unless explicitly overridden in the context config file.
    skin: dracula # => assumes the file skins/dracula.yaml is present in the  $XDG_DATA_HOME/k9s/skins directory
    # Allows to set certain views default fullscreen mode. (yaml, helm history, describe, value_extender, details, logs) Default false
    defaultsToFullScreen: false
```


## 8.5 Plugins

K9s å…è®¸ä½ é€šè¿‡ æ’ä»¶æœºåˆ¶ å®šä¹‰è‡ªå·±çš„é›†ç¾¤å‘½ä»¤æ¥æ‰©å±•ä½ çš„å‘½ä»¤è¡Œå’Œå·¥å…·ã€‚K9s ä¼šæŸ¥çœ‹ 

  Windows ä¸­ ` C:\Users\yzh\AppData\Local\k9s\plugins.yaml`


K9s allows you to extend your command line and tooling by defining your very own cluster commands via plugins. K9s will look at `$XDG_CONFIG_HOME/k9s/plugins.yaml` to locate all available plugins.

A plugin is defined as follows:

- Shortcut option represents the key combination a user would type to activate the plugin
- Override option make that the default action related to the shortcut will be overrided by the plugin
- Confirm option (when enabled) lets you see the command that is going to be executed and gives you an option to confirm or prevent execution
- Description will be printed next to the shortcut in the k9s menu
- Scopes defines a collection of resources names/short-names for the views associated with the plugin. You can specify `all` to provide this shortcut for all views.
- Command represents ad-hoc commands the plugin runs upon activation
- Background specifies whether or not the command runs in the background
- Args specifies the various arguments that should apply to the command above
- OverwriteOutput options allows plugin developers to provide custom messages on plugin execution

shortCut å¿«æ·é”®é€‰é¡¹ä»£è¡¨ç”¨æˆ·é”®å…¥æ¿€æ´»æ’ä»¶çš„ç»„åˆé”®ã€‚

confirm ç¡®è®¤é€‰é¡¹ï¼ˆå¯ç”¨æ—¶ï¼‰è®©ä½ çœ‹åˆ°å°†è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œå¹¶ç»™ä½ ä¸€ä¸ªç¡®è®¤æˆ–é˜»æ­¢æ‰§è¡Œçš„é€‰é¡¹ã€‚

description è¯´æ˜å°†è¢«æ‰“å°åœ¨ K9s èœå•ä¸­çš„å¿«æ·æ–¹å¼æ—è¾¹ã€‚

scopes ä½œç”¨åŸŸä¸ºä¸æ’ä»¶ç›¸å…³è”çš„è§†å›¾å®šä¹‰äº†èµ„æºåç§°/ç®€ç§°çš„é›†åˆã€‚ä½ å¯ä»¥æŒ‡å®šæ‰€æœ‰ï¼Œä¸ºæ‰€æœ‰è§†å›¾æä¾›è¿™ä¸ªå¿«æ·æ–¹å¼ã€‚ 

command ä»£è¡¨æ’ä»¶åœ¨æ¿€æ´»æ—¶è¿è¡Œçš„ä¸´æ—¶å‘½ä»¤ã€‚ 

background æŒ‡å®šå‘½ä»¤æ˜¯å¦åœ¨åå°è¿è¡Œã€‚

args æŒ‡å®šé€‚ç”¨äºä¸Šè¿°å‘½ä»¤çš„å„ç§å‚æ•°ã€‚




K9s does provide additional environment variables for you to customize your plugins arguments. Currently, the available environment variables are as follows:

- `$RESOURCE_GROUP` -- the selected resource group
- `$RESOURCE_VERSION` -- the selected resource api version
- `$RESOURCE_NAME` -- the selected resource name
- `$NAMESPACE` -- the selected resource namespace
- `$NAME` -- the selected resource name
- `$CONTAINER` -- the current container if applicable
- `$FILTER` -- the current filter if any
- `$KUBECONFIG` -- the KubeConfig location.
- `$CLUSTER` the active cluster name
- `$CONTEXT` the active context name
- `$USER` the active user
- `$GROUPS` the active groups
- `$POD` while in a container view
- `$COL-<RESOURCE_COLUMN_NAME>` use a given column name for a viewed resource. Must be prefixed by `COL-`!

K9s åŒæ—¶æä¾›äº†é¢å¤–çš„ç¯å¢ƒå˜é‡ï¼Œä¾›ä½ è‡ªå®šä¹‰æ’ä»¶çš„å‚æ•°ã€‚ç›®å‰ï¼Œå¯ç”¨çš„ç¯å¢ƒå˜é‡å¦‚ä¸‹ï¼š

    $NAMESPACEï¼šé€‰å®šçš„èµ„æºå‘½åç©ºé—´ 

    $NAMEï¼šæ‰€é€‰èµ„æºåç§° 

    $CONTAINER ï¼šå½“å‰å®¹å™¨ï¼ˆå¦‚æœé€‚ç”¨ï¼‰

    $FILTERï¼šå½“å‰çš„è¿‡æ»¤å™¨ï¼ˆå¦‚æœæœ‰ï¼‰

    $KUBECONFIGï¼šKubeConfig æ–‡ä»¶çš„ä½ç½® 

    $CLUSTERï¼šå½“å‰çš„é›†ç¾¤åç§° 

    $CONTEXTï¼šå½“å‰çš„ä¸Šä¸‹æ–‡åç§° 

    $USERï¼šå½“å‰ç”¨æˆ· 

    $GROUPSï¼šå½“å‰çš„ç”¨æˆ·ç»„ 

    $PODï¼šå®¹å™¨è§†å›¾ä¸­çš„ Pod 


Curly braces can be used to embed an environment variable inside another string, or if the column name contains special characters. (e.g. `${NAME}-example` or `${COL-%CPU/L}`)

### 8.5.1 Plugin Example

This defines a plugin for viewing logs on a selected pod using `ctrl-l` as shortcut.

```yaml
#  $XDG_DATA_HOME/k9s/plugins.yaml
plugins:
  # Defines a plugin to provide a `ctrl-l` shortcut to tail the logs while in pod view.
  fred:
    shortCut: Ctrl-L
    override: false
    confirm: false
    description: Pod logs
    scopes:
    - pods
    command: kubectl
    background: false
    args:
    - logs
    - -f
    - $NAME
    - -n
    - $NAMESPACE
    - --context
    - $CONTEXT
```

> NOTE: This is an experimental feature! Options and layout may change in future K9s releases as this feature solidifies.


### 8.5.2 è‡ªå®šä¹‰ Stern æ’ä»¶æ”¯æŒå¤š Pod çš„æ—¥å¿—æŸ¥è¯¢

[Stern](https://github.com/wercker/stern) æ˜¯ä¸€æ¬¾ç¤¾åŒºçŸ¥åçš„ K8s é›†ç¾¤æœåŠ¡æ—¥å¿—æŸ¥è¯¢å·¥å…·ï¼Œè™½ç„¶ k9s å·²ç„¶é›†æˆäº†éƒ¨åˆ† Stern çš„åŠŸèƒ½ï¼Œä½†æ“ä½œä¸å¤ªç›´æ¥ä¹Ÿæ— æ³•è¿æ¥ç®¡é“æ“ä½œï¼ˆ `|` ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ’ä»¶åˆ›å»ºä¸€ä¸ªå¯ä»¥æŸ¥è¯¢å½“å‰å‘½åç©ºé—´ä¸‹å¤šä¸ª Pod çš„å¿«æ·å‘½ä»¤ã€‚

```
# $HOME/.k9s/plugin.yml
plugin:
  stern:
    shortCut: Ctrl-L
    confirm: false
    description: "Logs (Stern)"
    scopes:
      - pods
    command: /usr/local/bin/stern # NOTE! Look for the command at this location.
    background: false
    args:
     - --tail
     - 100
     - $FILTER      # NOTE! Pulls the filter out of the pod view.
     - -n
     - $NAMESPACE   # Use current namespace
     - --context
     - $CONTEXT     # Use current k8s context
```


ç›´æ¥ä½¿ç”¨ stern åœ¨å‘½ä»¤è¡ŒæŸ¥è¯¢æ—¥å¿—
ä½¿ç”¨ stern å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°åŠ¨æ€æŸ¥çœ‹ Pod çš„æ—¥å¿—ä¿¡æ¯ã€‚Stern å¯ä»¥è®©ä½ æ ¹æ® Kubernetes ä¸­çš„ Pod å’Œå®¹å™¨ç”Ÿæˆä»¥ä¸åŒé¢œè‰²ç¼–ç çš„è¾“å‡ºã€‚stern å‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œä»¥ä¸‹åˆ—ä¸¾ä¸€äº›å¸¸è§ã€å¸¸ç”¨çš„æ“ä½œä½œä¸ºå‚è€ƒï¼š
```
# Tail all pods within a current namespace:
$ stern .

# Tail all pods that matches a given regular expression:
$ stern pod_query

# Tail matched pods from all namespaces:
$ stern pod_query --all-namespaces

# Tail matched pods from 15 minutes ago and ignore 'probe' messages:
$ stern pod_query -e probe -s 15m

# Tail matched pods with a specific label:
$ stern pod_query -l release=canary

# Pipe the log message to jq
$ stern pod_query -o json | jq .
```



# 9 K9s çš„éƒ¨åˆ†é«˜çº§åŠŸèƒ½

## 9.1 è¿‡æ»¤

å®ƒçš„è¿‡æ»¤åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œä½¿å¾—ä½ å¯ä»¥éå¸¸å¿«é€Ÿçš„å®šä½èµ„æºï¼Œæ¯”å¦‚æˆ‘æƒ³è¦çœ‹ traefik çš„æ‰€æœ‰ CRDï¼Œæ“ä½œå¦‚ä¸‹ï¼š

```bash
ctrl-a
/traefik
```

![traefik crd](https://img2023.cnblogs.com/other/3034537/202303/3034537-20230304160444661-84244328.png)

## 9.2 **å¿«é€Ÿå˜æ›´å·¥ä½œè´Ÿè½½çš„å‰¯æœ¬æ•°é‡**

é€šè¿‡ `:dp` æˆ– `:rs` è¿›å…¥ Deployments æˆ– StatefulSets è§†å›¾ç•Œé¢åï¼Œå¯ä»¥é€šè¿‡ `s` å¿«æ·é”®åœ¨æ‰€åœ¨èµ„æºä¸Šè°ƒå‡ºå‰¯æœ¬æ•°é‡ä¿®æ”¹çª—å£ï¼Œè¾“å…¥æ•°é‡å¹¶ç¡®å®šå³å¯å®Œæˆä¿®æ”¹ã€‚

![](https://i.cloudnative.to/~gitbook/image?url=https%3A%2F%2F2547706445-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-legacy-files%2Fo%2Fassets%252F-MNIMs8Ubg1Uqdpgfw0o%252Fsync%252F6cbe35fca56e0862fe4c06ed2351448e363bf9a0.png%3Fgeneration%3D1608212315045712%26alt%3Dmedia&width=768&dpr=4&quality=100&sign=c6db021f&sv=1)


## 9.3 **ä½¿ç”¨ Port Forward åœ¨æœ¬åœ°ä½¿ç”¨é›†ç¾¤å†…æœåŠ¡**

åœ¨ Pods, Deployments / StatefulSets, Services è§†å›¾ç•Œé¢éƒ½å¯ä»¥é€šè¿‡ `shift-f` çš„å¿«æ·é”®ï¼Œæ‰§è¡Œå®¹å™¨çš„æœ¬åœ°ç«¯å£æ˜ å°„æ“ä½œã€‚

![](https://i.cloudnative.to/~gitbook/image?url=https%3A%2F%2F2547706445-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-legacy-files%2Fo%2Fassets%252F-MNIMs8Ubg1Uqdpgfw0o%252F-MO9zTNxi9Wxg2V7HfLc%252F-MOAVWE8czHe41_SxG26%252Fimage.png%3Falt%3Dmedia%26token%3D2e40d18d-509e-48fa-aa3b-c1638a916023&width=768&dpr=4&quality=100&sign=2752baea&sv=1)

ç•Œé¢å¼¹å‡ºåï¼Œ å¯ä»¥æ‰‹åŠ¨ä¿®æ”¹ä¸Šé¢çš„ port number 


## 9.4 æŒ‰ ctrl-zæŸ¥çœ‹å¼‚å¸¸äº‹ä»¶

![Events](https://img2023.cnblogs.com/other/3034537/202303/3034537-20230304160445103-1823913617.png)

## 9.5 **ä½¿ç”¨ Pulses è§†å›¾è·Ÿè¸ªå®æ–½èµ„æºçŠ¶æ€**

é€šè¿‡ `:pu` , :pulse å¯ä»¥è¿›å…¥ä¸€ä¸ªæ‘˜è¦è§†å›¾ï¼Œè¿™ä¸ªè§†å›¾åˆ—å‡ºäº†é›†ç¾¤ä¸­æœ€å¸¸ç”¨çš„èµ„æºç±»å‹ï¼Œå’Œå®ƒä»¬çš„å½“å‰æ•°é‡åŠæ´»åŠ¨çŠ¶æ€ï¼Œä»¥ 5 ç§’ä¸ºå‘¨æœŸåˆ·æ–°ã€‚

![](https://i.cloudnative.to/~gitbook/image?url=https%3A%2F%2F2547706445-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-legacy-files%2Fo%2Fassets%252F-MNIMs8Ubg1Uqdpgfw0o%252Fsync%252F949b851d6f9aa5f690fcdf6532dc96e39545356e.png%3Fgeneration%3D1608212319481527%26alt%3Dmedia&width=768&dpr=4&quality=100&sign=f7cab946&sv=1)


## 9.6 **ä½¿ç”¨ XRay è§†å›¾è·å–èµ„æºçš„æ ‘çŠ¶å…³ç³»å›¾**
(ç›®å½•æ ‘çš„æ–¹å¼å±•ç¤ºK8sèµ„æº)ã€

XRay ä¼šæä¾›ä»¥æŸä¸ª Kubernetes èµ„æºä¸ºç»´åº¦çš„å…³è”å…³ç³»ï¼Œåƒ X å…‰ä¸€æ ·ï¼Œé€å°„åˆ°èµ„æºçš„å†…éƒ¨ã€‚å¦‚ä¸‹å›¾ï¼š

é€šè¿‡ `:x <res> [ns]` å¯ä»¥è¿›å…¥ XRay è§†å›¾ï¼Œä»è€ŒæŸ¥çœ‹å’Œéå†èµ„æºä¹‹é—´çš„å…³ç³»å’Œå…³è”ï¼Œå¹¶æ£€æŸ¥å¼•ç”¨çš„å®Œæ•´æ€§ã€‚æ¯”å¦‚æˆ‘ä»¬é€šè¿‡ `:x dp` å¯ä»¥è¿›å…¥å¦‚ä¸‹çš„ Deployments èµ„æº XRay è§†å›¾ï¼Œå®ƒä¼šä»¥ Deployments ä¸ºåŸºç¡€é€šè¿‡æ ‘çŠ¶å…³ç³»å›¾ç½—åˆ—å…¶æ‰€åŒ…å«çš„ Pods åŠ Pods æ‰€ç»‘å®šçš„å…¶å®ƒèµ„æºã€‚ç›®å‰ XRay æ”¯æŒæ¢æŸ¥ï¼šPods, Deployments, StatefulSets, Services, DaemonSetsã€‚

![](https://i.cloudnative.to/~gitbook/image?url=https%3A%2F%2F2547706445-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-legacy-files%2Fo%2Fassets%252F-MNIMs8Ubg1Uqdpgfw0o%252Fsync%252Fcddba58433bd0807ed80a916b8da5d4c9066e50f.png%3Fgeneration%3D1608212316091672%26alt%3Dmedia&width=768&dpr=4&quality=100&sign=b70fd429&sv=1)

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯ä»¥ç›´æ¥ä» XRay è§†å›¾ä¸­æ“ä½œå¯¹åº”çš„èµ„æºï¼›å¹¶ä¸”å¯ä»¥ç”¨ `/` å¿«æ·é”®æ¥å¯¹å½“å‰çš„æ ¹èµ„æºè¿›è¡Œè¿‡æ»¤ã€‚


## 9.7 **ä½¿ç”¨ Popeye æ£€æŸ¥èµ„æºé…ç½®çš„åˆç†ç¨‹åº¦**

> [Popeye](https://popeyecli.io/) æ˜¯ K9s ä½œè€…å¼€å‘çš„å¦ä¸€ä¸ª K8s å‘½ä»¤è¡Œå·¥å…·ï¼Œç°å·²è¢«é›†æˆè¿› K9sï¼Œå®ƒå¯ä»¥å®æ—¶æ‰«æä½ çš„é›†ç¾¤ï¼Œå¹¶æŠ¥å‘Šæ½œåœ¨çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼šå¼•ç”¨å®Œæ•´æ€§ã€é…ç½®é”™è¯¯ã€èµ„æºä½¿ç”¨ç­‰ã€‚


Popeyeï¼ˆå¤§åŠ›æ°´æ‰‹ï¼‰å°±æ˜¯ä¸ºé›†ç¾¤ã€ä»¥åŠé›†ç¾¤å†…çš„æ¯éš”èµ„æºæ‰“åˆ†ï¼Œåˆ†æ•°ä» 0 - 100ï¼Œæœ€åæ ¹æ®å¾—åˆ†è¯„å‡ºä½ çš„é›†ç¾¤çš„æƒ…å†µï¼šå¾—åˆ†æ˜¯ A è¿˜æ˜¯ Cï¼Œå¹¶ç»™å‡ºå…·ä½“åŸå› ã€‚

é€šè¿‡ `:popeye` å‘½ä»¤å¯ä»¥è¿›å…¥ Popeye çš„æ€»è§ˆè§†å›¾ï¼Œç„¶åå¯ä»¥é€šè¿‡åœ¨ç»™å®šçš„èµ„æºæ¡ç›®ä¸ŠæŒ‰ `Enter` é”®æ¥æŸ¥çœ‹æ›´ä¸ºè¯¦ç»†çš„æ£€æµ‹æŠ¥å‘Šã€‚

![](https://i.cloudnative.to/~gitbook/image?url=https%3A%2F%2F2547706445-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-legacy-files%2Fo%2Fassets%252F-MNIMs8Ubg1Uqdpgfw0o%252Fsync%252Fa3ebfb269a17eb3ff858d8ca1b1511379778ac4b.png%3Fgeneration%3D1608212319248115%26alt%3Dmedia&width=768&dpr=4&quality=100&sign=fa9f99d2&sv=1)

![](https://i.cloudnative.to/~gitbook/image?url=https%3A%2F%2F2547706445-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-legacy-files%2Fo%2Fassets%252F-MNIMs8Ubg1Uqdpgfw0o%252Fsync%252Fd651d1352b8c5213e146c798d4dd83befce6b673.png%3Fgeneration%3D1608212310173349%26alt%3Dmedia&width=768&dpr=4&quality=100&sign=d2096bed&sv=1)

Popeye è¿˜æ”¯æŒä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå³ `spinach.yml`ï¼Œè¯¥æ–‡ä»¶æä¾›äº†è‡ªå®šä¹‰æ‰«æèµ„æºçš„å†…å®¹ï¼Œå¹¶æ ¹æ®è‡ªå·±çš„ç­–ç•¥è®¾ç½®ä¸åŒçš„ä¸¥é‡ç¨‹åº¦ã€‚

è¯·é˜…è¯» [Popeye æ–‡æ¡£](https://popeyecli.io/#the-spinachyaml-configuration)ï¼Œäº†è§£å¦‚ä½•è‡ªå®šä¹‰æŠ¥å‘Šã€‚`spinach.yml` æ–‡ä»¶å°†ä» K9s çš„ä¸»ç›®å½• `$HOME/.k9s/MY_CLUSTER_CONTEXT_NAME_spinach.yml` ä¸­è¯»å–ã€‚


DaemonSet å¾— 0 åˆ†åŸå› æ˜¯éƒ½æ²¡æŒ‡å®š requests å’Œ limitsï¼š

![DaemonSet 0 åˆ†åŸå› ](https://img2023.cnblogs.com/other/3034537/202303/3034537-20230304160445818-1917860290.png)


Service å¾— 20 åˆ†åŸå› å°±å¤šäº†ï¼Œç”šè‡³è¿˜è´´å¿ƒè€ƒè™‘åˆ°äº†å¼€é”€è´µä¸è´µçš„é—®é¢˜ï¼š

![Service 20åˆ† åŸå› ](https://img2023.cnblogs.com/other/3034537/202303/3034537-20230304160446022-745731227.png)



## 9.8 ç›´è§‚çš„ RBAC

RBAC çš„ yaml çœ‹èµ·æ¥å¾ˆä¸æ–¹ä¾¿çš„ï¼Œå¦‚æœå¯¹æƒé™æ¯”è¾ƒè¦æ±‚æ¯”è¾ƒå¤šï¼Œé‚£ K9S ç»å¯¹å¥½ç”¨ç›´è§‚ï¼Œå¦‚ä¸‹ï¼Œtraefik role æœ‰å“ªäº›æƒé™ä¸€ç›®äº†ç„¶ï¼šwhoã€whatã€howã€‚

![RBAC è§†å›¾](https://img2023.cnblogs.com/other/3034537/202303/3034537-20230304160446256-1576236801.png)


## 9.9 port-forward å»è®¿é—®


å› ä¸ºç¤ºä¾‹çš„Nginxåªä¼šæ˜¾ç¤ºè®¿é—®æ—¥å¿—ï¼Œè¿™æ—¶å€™ç•Œé¢ä¼šæç¤º`Waiting for logs...`.

å¦‚æœæˆ‘ä»¬å¿«é€Ÿè®¿é—®Nginxï¼Œè¯¥æ€ä¹ˆåšï¼Ÿåœ¨K9sé‡Œé¢æœ‰ä¸¤ç§æ–¹å¼

1 
ç¬¬ä¸€ç§æ˜¯ä½¿ç”¨Shellï¼Œè¯¥å‘½ä»¤ç­‰ä»·äº`kubectl exec pod /bin/sh`ã€‚å…ˆç”¨ESCé€€å›Podç•Œé¢ï¼Œå†æŒ‰ä¸‹`s`ï¼Œå°±ä¼šè¿›å…¥åˆ°å®¹å™¨çš„Shellå‘½ä»¤è¡Œã€‚å¦‚æœä¸€ä¸ªPodåŒ…å«äº†å¤šä¸ªContainerï¼Œåˆ™ä¼šè¿›å…¥Containerç•Œé¢è®©ä½ é€‰æ‹©è¦è¿›å…¥çš„Containerã€‚

è¿™ç§æ–¹å¼æ˜¯å°±æ˜¯å½“åˆK9så¸å¼•æˆ‘ä½¿ç”¨çš„åœ°æ–¹ï¼Œå¯¹æ¯”è‡ªå·±å»æ‹¼å‘½ä»¤ï¼Œè¿™ä¸ªè¦å¿«æ·æ–¹ä¾¿å¾ˆå¤šã€‚

æ¥ç€è¾“å…¥`curl localhost:80`ï¼Œä½†å¯æƒœçš„æ˜¯é•œåƒæ²¡æœ‰è‡ªå¸¦curlã€‚

2 
é‚£åªæœ‰ç”¨ç¬¬äºŒç§æ–¹æ³•ï¼Œport-forwardã€‚`exit`é€€å‡ºå‘½ä»¤è¡Œç•Œé¢è¾“å…¥å¿«æ·é”®`Shift+f`è¿›å…¥PortForwardç•Œé¢ã€‚

![portforward](https://rainfd.com/img/19/portforward.png)

è¿™ä¸ªå°±æ˜¯å¯¹åº”`kubectl port-forward`å‘½ä»¤ã€‚æ­¤æ—¶ä½¿ç”¨`Tab`è¿›è¡Œä¸Šä¸‹åˆ‡æ¢ã€‚ç¡®è®¤åæœ¬åœ°å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯è®¿é—® `curl localhost:80`ã€‚

_port-forwardåœ¨K9så…³é—­åå°±ä¼šå¤±æ•ˆ_



## 9.10 æ—¥å¿—çš„æŸ¥çœ‹ 

ç°åœ¨å›åˆ°æ—¥å¿—ç•Œé¢å°±ä¼šçœ‹åˆ°æ–°çš„æ—¥å¿—ã€‚

![log](https://rainfd.com/img/19/log.png)

åœ¨æ—¥å¿—ç•Œé¢çš„æµè§ˆå’ŒVimæµè§ˆä¹Ÿä¸€æ ·ï¼Œç§»åŠ¨æ–¹å¼ã€è¿‡æ»¤å’Œä¸Šä¸‹è·³è½¬ç­‰æ“ä½œéƒ½èƒ½é€‚ç”¨ã€‚

_æˆ‘ä¸€èˆ¬åœ¨æŸ¥çœ‹å®¹å™¨æ—¥å¿—çš„æ—¶å€™ä¼šæŒ‰ 0å’Œ wï¼Œ0ä»£è¡¨æŸ¥çœ‹æ—¥å¿—çš„å°¾éƒ¨ï¼Œå³æœ€æ–°æ—¥å¿—ï¼Œwä»£è¡¨æ—¥å¿—è‡ªåŠ¨æ¢è¡Œã€‚_


## 9.11 Node Shell(åœ¨Nodeç•Œé¢æŒ‰sè¿›å…¥è¯¥ä¸»æœºçš„å®¹å™¨)



